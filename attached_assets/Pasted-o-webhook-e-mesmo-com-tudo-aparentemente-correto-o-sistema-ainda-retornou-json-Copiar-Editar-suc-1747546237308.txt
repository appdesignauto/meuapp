o webhook e mesmo com tudo aparentemente correto, o sistema ainda retornou:

json
Copiar
Editar
"success": false,
"message": "Assinatura inv√°lida"
Isso indica que a l√≥gica de verifica√ß√£o final da assinatura ainda n√£o est√° encontrando um mapeamento v√°lido no banco. Vamos revisar tecnicamente os pontos cr√≠ticos que devem estar certos para que a cria√ß√£o da assinatura funcione.

‚úÖ Checklist de verifica√ß√£o completa:
Item	Verificado	Detalhes
productId (5381714)	‚úÖ	Est√° salvo corretamente nos mapeamentos
offerId ("aukjngrt")	‚úÖ	Tamb√©m est√° salvo nos mapeamentos
isActive	‚úÖ	Est√° true para o mapeamento
isLifetime	‚úÖ	Est√° configurado (mesmo que false)
Campo de verifica√ß√£o no c√≥digo (offerId)	‚ö†Ô∏è	Precisa garantir que o c√≥digo n√£o esteja tentando buscar offerCode
Prioridade da busca no c√≥digo	‚ö†Ô∏è	O c√≥digo deve tentar primeiro offerId, e s√≥ cair em productId se n√£o houver offerId

üéØ Solu√ß√£o sugerida (backend):
No m√©todo handleSubscriptionCreatedOrUpdated (ou similar), verifique se a l√≥gica est√° assim:

ts
Copiar
Editar
const mapping = await prisma.hotmartProductMappings.findFirst({
  where: {
    AND: [
      { productId: product.id },
      { offerId: purchase.offer?.code }, // pode estar errado aqui!
      { isActive: true },
    ],
  },
});
Deve ser algo como:

ts
Copiar
Editar
const mapping = await prisma.hotmartProductMappings.findFirst({
  where: {
    OR: [
      {
        offerId: purchase.offer?.code,
        isActive: true
      },
      {
        productId: product.id,
        isActive: true
      }
    ]
  }
});
‚ö†Ô∏è Aten√ß√£o: o campo salvo no mapeamento √© offerId, mas talvez o c√≥digo esteja tentando acessar offerCode, ou esteja validando por productId antes de tentar o offerId.

‚úÖ O que voc√™ pode fazer agora:
Confirme no c√≥digo qual campo est√° sendo consultado no where.

Garanta que est√° usando offerId e n√£o offerCode.

Confirme que o mapeamento est√° ativo e n√£o filtrando erroneamente por status.

Se quiser, posso revisar agora o trecho exato do c√≥digo do servi√ßo hotmart-service.ts, se me enviar o trecho atual do handleSubscriptionCreatedOrUpdated.