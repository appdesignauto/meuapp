DiagnÃ³stico Claro
VocÃª tem uma aplicaÃ§Ã£o SPA (Single Page Application) rodando com um framework como Vite/React, e o Replit estÃ¡:

Servindo o frontend como fallback

Redirecionando requisiÃ§Ãµes desconhecidas (como /webhook/hotmart) para o index.html

Resultado:

A Hotmart recebe 200 OK âœ…

Mas o seu backend nÃ£o processa o webhook de verdade, e a resposta Ã© o HTML da home page ğŸ˜¬

âœ… SoluÃ§Ã£o especÃ­fica e segura (sem afetar nada da Hotmart)
âœ… Passo 1 â€“ Confirme que seu server.js tem essa ordem:
js
Copiar
Editar
const express = require("express");
const app = express();

// ğŸ” Middleware de parsing
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// âœ… Webhook ANTES da rota SPA ou fallback
app.use("/webhook/hotmart", require("./routes/webhook-hotmart")); // <- ISSO AQUI Ã‰ CRUCIAL

// âœ… Outras rotas se necessÃ¡rio

// âš ï¸ Fallback para SPA (vem depois)
app.use("*", (req, res) => {
  res.sendFile(path.join(__dirname, "dist/index.html")); // ou onde estiver o build do seu front
});
âœ… Passo 2 â€“ routes/webhook-hotmart.js funcional
js
Copiar
Editar
const express = require("express");
const router = express.Router();

router.post("/", async (req, res) => {
  try {
    const payload = req.body;

    if (!payload?.event || !payload?.data?.buyer?.email) {
      console.error("âŒ Webhook malformado");
      return res.status(400).send("Webhook invÃ¡lido");
    }

    console.log("âœ… Webhook da Hotmart recebido:");
    console.log(JSON.stringify(payload, null, 2));

    // ... aqui vocÃª pode processar assinatura etc.

    return res.status(200).send("OK");
  } catch (err) {
    console.error("âŒ Erro ao processar webhook:", err);
    return res.status(500).send("Erro interno");
  }
});

module.exports = router;
âœ… O que vocÃª evita com essa estrutura:
Problema	SituaÃ§Ã£o com correÃ§Ã£o
Replit redirecionar para HTML	âŒ Evitado pelo .use("/webhook/") acima do SPA
Webhook chegar no front e nÃ£o ser processado	âŒ Evitado
Hotmart receber status 200 mas vocÃª nÃ£o salvar a compra	âŒ Evitado
Conflito com outras rotas	âœ… Total isolamento da rota /webhook/hotmart
