#!/bin/bash

# ================================================================
# DESIGNAUTO - DEPLOYMENT PROFISSIONAL DO MODO ESCURO NO REPLIT
# ================================================================
# Execução: bash deploy-darkmode.sh
# Versão: 2.0 - Implementação Inteligente e Profissional

echo "🚀 DESIGNAUTO - DARK MODE PROFESSIONAL DEPLOYMENT"
echo "================================================="
echo ""

# Cores para output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m'

# Configurações
PROJECT_NAME="DesignAuto"
BACKUP_DIR="backup_$(date +%Y%m%d_%H%M%S)"
THEME_VERSION="2.0"

# ================================================================
# FASE 1: PREPARAÇÃO E BACKUP
# ================================================================

prepare_deployment() {
    echo -e "${BLUE}📋 FASE 1: PREPARAÇÃO DO AMBIENTE${NC}"
    echo "=================================="
    
    # Verificar se estamos no Replit
    if [ ! -f ".replit" ]; then
        echo -e "${YELLOW}⚠️  Não detectado ambiente Replit. Continuando...${NC}"
    else
        echo -e "${GREEN}✅ Ambiente Replit detectado${NC}"
    fi
    
    # Criar backup dos arquivos existentes
    echo ""
    echo "📦 Criando backup de segurança..."
    mkdir -p "$BACKUP_DIR"
    
    # Backup de arquivos críticos
    [ -f "index.html" ] && cp index.html "$BACKUP_DIR/"
    [ -f "style.css" ] && cp style.css "$BACKUP_DIR/"
    [ -f "script.js" ] && cp script.js "$BACKUP_DIR/"
    [ -f "main.css" ] && cp main.css "$BACKUP_DIR/"
    [ -d "css" ] && cp -r css "$BACKUP_DIR/"
    [ -d "js" ] && cp -r js "$BACKUP_DIR/"
    
    echo "✅ Backup criado em: $BACKUP_DIR"
    
    # Verificar dependências
    echo ""
    echo "🔍 Verificando estrutura do projeto..."
    
    # Detectar tipo de projeto
    if [ -f "package.json" ]; then
        PROJECT_TYPE="nodejs"
        echo "   📦 Projeto Node.js detectado"
    elif [ -f "index.html" ]; then
        PROJECT_TYPE="static"
        echo "   🌐 Projeto HTML estático detectado"
    elif [ -f "main.py" ]; then
        PROJECT_TYPE="python"
        echo "   🐍 Projeto Python detectado"
    else
        PROJECT_TYPE="unknown"
        echo "   ❓ Tipo de projeto não identificado"
    fi
    
    echo ""
}

# ================================================================
# FASE 2: IMPLEMENTAÇÃO DO SISTEMA DE CORES
# ================================================================

implement_color_system() {
    echo -e "${PURPLE}🎨 FASE 2: IMPLEMENTAÇÃO DO SISTEMA DE CORES${NC}"
    echo "============================================="
    
    # Criar arquivo de variáveis CSS
    cat > "theme-variables.css" << 'EOF'
/* ================================================================
   DESIGNAUTO - SISTEMA PROFISSIONAL DE CORES
   Versão: 2.0 | Implementação: Replit Ready
   ================================================================ */

:root {
    /* === BRAND COLORS === */
    --designauto-primary: #3b82f6;
    --designauto-primary-hover: #2563eb;
    --designauto-primary-light: #dbeafe;
    --designauto-primary-dark: #1e40af;
    
    --designauto-secondary: #64748b;
    --designauto-secondary-hover: #475569;
    
    --designauto-accent: #8b5cf6;
    --designauto-accent-hover: #7c3aed;
    
    /* === STATUS COLORS === */
    --designauto-success: #10b981;
    --designauto-warning: #f59e0b;
    --designauto-error: #ef4444;
    --designauto-info: #06b6d4;
    
    /* === LIGHT THEME === */
    --bg-primary: #ffffff;
    --bg-secondary: #f8fafc;
    --bg-tertiary: #f1f5f9;
    --bg-elevated: #ffffff;
    --bg-overlay: rgba(0, 0, 0, 0.1);
    --bg-hover: #f1f5f9;
    
    --text-primary: #0f172a;
    --text-secondary: #475569;
    --text-tertiary: #64748b;
    --text-quaternary: #94a3b8;
    --text-inverse: #ffffff;
    --text-muted: #cbd5e1;
    
    --border-primary: #e2e8f0;
    --border-secondary: #cbd5e1;
    --border-focus: #3b82f6;
    --border-hover: #94a3b8;
    
    /* === SHADOWS === */
    --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    
    /* === TRANSITIONS === */
    --transition-fast: 0.15s ease-out;
    --transition-normal: 0.25s ease-out;
    --transition-slow: 0.4s ease-out;
    
    /* === COMPONENT VARIABLES === */
    --navbar-height: 64px;
    --sidebar-width: 280px;
    --container-max-width: 1200px;
    --border-radius: 8px;
    --border-radius-lg: 12px;
}

/* ================================================================
   DARK THEME OVERRIDES
   ================================================================ */

[data-theme="dark"] {
    /* === DARK BACKGROUNDS === */
    --bg-primary: #0f172a;
    --bg-secondary: #1e293b;
    --bg-tertiary: #334155;
    --bg-elevated: #1e293b;
    --bg-overlay: rgba(255, 255, 255, 0.1);
    --bg-hover: #334155;
    
    /* === DARK TEXT === */
    --text-primary: #f8fafc;
    --text-secondary: #cbd5e1;
    --text-tertiary: #94a3b8;
    --text-quaternary: #64748b;
    --text-inverse: #0f172a;
    --text-muted: #475569;
    
    /* === DARK BORDERS === */
    --border-primary: #334155;
    --border-secondary: #475569;
    --border-focus: #60a5fa;
    --border-hover: #64748b;
    
    /* === ADJUSTED BRAND COLORS FOR DARK === */
    --designauto-primary: #60a5fa;
    --designauto-primary-hover: #3b82f6;
    --designauto-primary-light: #1e3a8a;
    
    --designauto-accent: #a78bfa;
    --designauto-accent-hover: #8b5cf6;
    
    /* === DARK SHADOWS === */
    --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.4);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.6);
}

/* ================================================================
   GLOBAL STYLES
   ================================================================ */

* {
    transition: background-color var(--transition-normal), 
                color var(--transition-normal), 
                border-color var(--transition-normal);
}

body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
}

/* ================================================================
   COMPONENT STYLES
   ================================================================ */

.designauto-card {
    background-color: var(--bg-elevated);
    border: 1px solid var(--border-primary);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-sm);
}

.designauto-btn {
    background-color: var(--designauto-primary);
    color: var(--text-inverse);
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.designauto-btn:hover {
    background-color: var(--designauto-primary-hover);
    transform: translateY(-1px);
}

.designauto-input {
    background-color: var(--bg-primary);
    border: 1px solid var(--border-primary);
    color: var(--text-primary);
    padding: 0.75rem;
    border-radius: var(--border-radius);
}

.designauto-input:focus {
    border-color: var(--border-focus);
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.designauto-navbar {
    background-color: var(--bg-elevated);
    border-bottom: 1px solid var(--border-primary);
    height: var(--navbar-height);
}

.designauto-sidebar {
    background-color: var(--bg-secondary);
    border-right: 1px solid var(--border-primary);
    width: var(--sidebar-width);
}
EOF

    echo "✅ Sistema de cores criado: theme-variables.css"
    
    # Criar arquivo de componentes
    cat > "theme-components.css" << 'EOF'
/* ================================================================
   DESIGNAUTO - COMPONENTES TEMÁTICOS
   ================================================================ */

/* === TOGGLE SWITCH === */
.theme-toggle {
    position: relative;
    width: 60px;
    height: 30px;
    background-color: var(--bg-tertiary);
    border: 2px solid var(--border-primary);
    border-radius: 15px;
    cursor: pointer;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    padding: 2px;
}

.theme-toggle:hover {
    border-color: var(--designauto-primary);
}

.theme-toggle-slider {
    width: 22px;
    height: 22px;
    background-color: var(--text-primary);
    border-radius: 50%;
    transition: all var(--transition-normal);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
}

[data-theme="dark"] .theme-toggle-slider {
    transform: translateX(30px);
    background-color: var(--designauto-primary);
}

.theme-icon {
    transition: opacity var(--transition-fast);
}

.sun-icon { opacity: 1; }
.moon-icon { opacity: 0; position: absolute; }

[data-theme="dark"] .sun-icon { opacity: 0; }
[data-theme="dark"] .moon-icon { opacity: 1; }

/* === UTILITY CLASSES === */
.bg-primary { background-color: var(--bg-primary); }
.bg-secondary { background-color: var(--bg-secondary); }
.bg-elevated { background-color: var(--bg-elevated); }

.text-primary { color: var(--text-primary); }
.text-secondary { color: var(--text-secondary); }
.text-muted { color: var(--text-muted); }

.border-primary { border-color: var(--border-primary); }
.border-focus { border-color: var(--border-focus); }

.shadow-sm { box-shadow: var(--shadow-sm); }
.shadow-md { box-shadow: var(--shadow-md); }
.shadow-lg { box-shadow: var(--shadow-lg); }
EOF

    echo "✅ Componentes criados: theme-components.css"
    echo ""
}

# ================================================================
# FASE 3: IMPLEMENTAÇÃO DO JAVASCRIPT
# ================================================================

implement_javascript() {
    echo -e "${YELLOW}⚡ FASE 3: IMPLEMENTAÇÃO DO CONTROLADOR JAVASCRIPT${NC}"
    echo "================================================="
    
    cat > "theme-controller.js" << 'EOF'
/**
 * ================================================================
 * DESIGNAUTO - CONTROLADOR PROFISSIONAL DE TEMA
 * Versão: 2.0 | Replit Ready | Production Grade
 * ================================================================
 */

class DesignAutoThemeController {
    constructor(options = {}) {
        this.storageKey = options.storageKey || 'designauto-theme';
        this.defaultTheme = options.defaultTheme || 'light';
        this.enableSystemDetection = options.enableSystemDetection !== false;
        this.enableTransitions = options.enableTransitions !== false;
        this.callbacks = {
            onThemeChange: options.onThemeChange || null,
            onInit: options.onInit || null
        };
        
        this.currentTheme = this.defaultTheme;
        this.systemMediaQuery = null;
        
        this.init();
    }

    /**
     * Inicializa o controlador de tema
     */
    init() {
        try {
            // Detectar preferência salva ou do sistema
            const savedTheme = this.getSavedTheme();
            const systemTheme = this.getSystemTheme();
            
            this.currentTheme = savedTheme || systemTheme || this.defaultTheme;
            
            // Aplicar tema inicial
            this.applyTheme(this.currentTheme, false);
            
            // Configurar listener para mudanças do sistema
            if (this.enableSystemDetection) {
                this.setupSystemListener();
            }
            
            // Configurar atalho de teclado
            this.setupKeyboardShortcut();
            
            // Callback de inicialização
            if (this.callbacks.onInit) {
                this.callbacks.onInit(this.currentTheme);
            }
            
            console.log(`🎨 DesignAuto Theme Controller iniciado: ${this.currentTheme}`);
            
        } catch (error) {
            console.error('Erro ao inicializar tema:', error);
            this.applyTheme(this.defaultTheme, false);
        }
    }

    /**
     * Aplica o tema especificado
     * @param {string} theme - 'light' ou 'dark'
     * @param {boolean} save - Se deve salvar no localStorage
     */
    applyTheme(theme, save = true) {
        if (!['light', 'dark'].includes(theme)) {
            console.warn(`Tema inválido: ${theme}. Usando ${this.defaultTheme}`);
            theme = this.defaultTheme;
        }

        // Aplicar atributo data-theme
        document.documentElement.setAttribute('data-theme', theme);
        
        // Atualizar meta theme-color para mobile
        this.updateMetaThemeColor(theme);
        
        // Salvar preferência
        if (save) {
            this.saveTheme(theme);
        }
        
        // Atualizar estado interno
        const previousTheme = this.currentTheme;
        this.currentTheme = theme;
        
        // Disparar callback
        if (this.callbacks.onThemeChange && previousTheme !== theme) {
            this.callbacks.onThemeChange(theme, previousTheme);
        }
        
        // Disparar evento customizado
        this.dispatchThemeEvent(theme, previousTheme);
    }

    /**
     * Alterna entre light e dark
     */
    toggle() {
        const newTheme = this.currentTheme === 'light' ? 'dark' : 'light';
        this.applyTheme(newTheme);
        return newTheme;
    }

    /**
     * Obtém o tema atual
     */
    getCurrentTheme() {
        return this.currentTheme;
    }

    /**
     * Define um tema específico
     * @param {string} theme 
     */
    setTheme(theme) {
        this.applyTheme(theme);
    }

    /**
     * Obtém tema salvo no localStorage
     */
    getSavedTheme() {
        try {
            return localStorage.getItem(this.storageKey);
        } catch {
            return null;
        }
    }

    /**
     * Salva tema no localStorage
     * @param {string} theme 
     */
    saveTheme(theme) {
        try {
            localStorage.setItem(this.storageKey, theme);
        } catch (error) {
            console.warn('Não foi possível salvar tema:', error);
        }
    }

    /**
     * Obtém preferência do sistema
     */
    getSystemTheme() {
        if (!this.enableSystemDetection) return null;
        
        try {
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        } catch {
            return null;
        }
    }

    /**
     * Configura listener para mudanças do sistema
     */
    setupSystemListener() {
        try {
            this.systemMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
            
            const handleSystemChange = (e) => {
                // Só aplicar se não há preferência salva
                if (!this.getSavedTheme()) {
                    const systemTheme = e.matches ? 'dark' : 'light';
                    this.applyTheme(systemTheme, false);
                }
            };
            
            // Suporte para navegadores modernos e legados
            if (this.systemMediaQuery.addEventListener) {
                this.systemMediaQuery.addEventListener('change', handleSystemChange);
            } else {
                this.systemMediaQuery.addListener(handleSystemChange);
            }
        } catch (error) {
            console.warn('Não foi possível configurar listener do sistema:', error);
        }
    }

    /**
     * Configura atalho de teclado (Ctrl/Cmd + Shift + D)
     */
    setupKeyboardShortcut() {
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'D') {
                e.preventDefault();
                this.toggle();
            }
        });
    }

    /**
     * Atualiza meta theme-color
     * @param {string} theme 
     */
    updateMetaThemeColor(theme) {
        let metaThemeColor = document.querySelector('meta[name="theme-color"]');
        
        if (!metaThemeColor) {
            metaThemeColor = document.createElement('meta');
            metaThemeColor.name = 'theme-color';
            document.head.appendChild(metaThemeColor);
        }
        
        const color = theme === 'dark' ? '#0f172a' : '#ffffff';
        metaThemeColor.setAttribute('content', color);
    }

    /**
     * Dispara evento customizado
     * @param {string} currentTheme 
     * @param {string} previousTheme 
     */
    dispatchThemeEvent(currentTheme, previousTheme) {
        try {
            const event = new CustomEvent('designauto:themechange', {
                detail: {
                    currentTheme,
                    previousTheme,
                    timestamp: Date.now()
                }
            });
            window.dispatchEvent(event);
        } catch (error) {
            console.warn('Erro ao disparar evento:', error);
        }
    }

    /**
     * Remove listeners e limpa recursos
     */
    destroy() {
        if (this.systemMediaQuery) {
            try {
                if (this.systemMediaQuery.removeEventListener) {
                    this.systemMediaQuery.removeEventListener('change', this.handleSystemChange);
                } else {
                    this.systemMediaQuery.removeListener(this.handleSystemChange);
                }
            } catch (error) {
                console.warn('Erro ao remover listener:', error);
            }
        }
    }
}

/**
 * ================================================================
 * INICIALIZAÇÃO AUTOMÁTICA
 * ================================================================
 */

// Aguardar DOM estar pronto
function initializeTheme() {
    // Configurações para DesignAuto
    const themeOptions = {
        storageKey: 'designauto-theme',
        defaultTheme: 'light',
        enableSystemDetection: true,
        enableTransitions: true,
        onThemeChange: (newTheme, oldTheme) => {
            console.log(`🎨 Tema alterado: ${oldTheme} → ${newTheme}`);
            
            // Opcional: Mostrar notificação
            if (typeof showThemeNotification === 'function') {
                showThemeNotification(newTheme);
            }
        },
        onInit: (theme) => {
            console.log(`🚀 DesignAuto iniciado com tema: ${theme}`);
        }
    };
    
    // Criar instância global
    window.DesignAutoTheme = new DesignAutoThemeController(themeOptions);
    
    // Funções globais de conveniência
    window.toggleTheme = () => window.DesignAutoTheme.toggle();
    window.setTheme = (theme) => window.DesignAutoTheme.setTheme(theme);
    window.getCurrentTheme = () => window.DesignAutoTheme.getCurrentTheme();
}

// Inicializar quando DOM estiver pronto
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeTheme);
} else {
    initializeTheme();
}

/**
 * ================================================================
 * UTILITÁRIOS EXTRAS
 * ================================================================
 */

// Função para mostrar notificação de tema (opcional)
function showThemeNotification(theme) {
    const message = theme === 'dark' ? '🌙 Modo escuro ativado' : '☀️ Modo claro ativado';
    
    // Se existe biblioteca de toast/notification, usar
    if (typeof toast !== 'undefined') {
        toast(message);
    } else {
        // Fallback simples
        console.log(message);
    }
}

// Exportar para Node.js se necessário
if (typeof module !== 'undefined' && module.exports) {
    module.exports = DesignAutoThemeController;
}
EOF

    echo "✅ Controlador JavaScript criado: theme-controller.js"
    echo ""
}

# ================================================================
# FASE 4: INTEGRAÇÃO AUTOMÁTICA
# ================================================================

integrate_with_project() {
    echo -e "${CYAN}🔧 FASE 4: INTEGRAÇÃO AUTOMÁTICA${NC}"
    echo "================================="
    
    case $PROJECT_TYPE in
        "nodejs")
            integrate_nodejs
            ;;
        "static")
            integrate_static
            ;;
        "python")
            integrate_python
            ;;
        *)
            integrate_generic
            ;;
    esac
    
    echo ""
}

integrate_static() {
    echo "🌐 Integrando com projeto HTML estático..."
    
    # Verificar se existe index.html
    if [ -f "index.html" ]; then
        echo "   📄 Modificando index.html..."
        
        # Backup do index original
        cp index.html "$BACKUP_DIR/index.html.original"
        
        # Adicionar imports no head
        sed -i '/<\/head>/i\    <!-- DesignAuto Theme System -->\
    <link rel="stylesheet" href="theme-variables.css">\
    <link rel="stylesheet" href="theme-components.css">\
    <script src="theme-controller.js"></script>' index.html
        
        echo "   ✅ Links adicionados ao HTML"
    else
        echo "   📄 Criando index.html básico..."
        create_sample_html
    fi
}

integrate_nodejs() {
    echo "📦 Integrando com projeto Node.js..."
    
    # Verificar estrutura
    if [ -d "public" ]; then
        echo "   📁 Movendo arquivos para /public"
        mv theme-*.css theme-*.js public/
    elif [ -d "static" ]; then
        echo "   📁 Movendo arquivos para /static"
        mv theme-*.css theme-*.js static/
    else
        echo "   📁 Mantendo arquivos na raiz"
    fi
}

integrate_python() {
    echo "🐍 Integrando com projeto Python..."
    
    # Verificar Flask/Django
    if [ -d "templates" ]; then
        echo "   🌶️  Estrutura Flask/Django detectada"
        mkdir -p static/css static/js
        mv theme-*.css static/css/
        mv theme-*.js static/js/
    else
        echo "   📁 Mantendo na raiz"
    fi
}

integrate_generic() {
    echo "❓ Projeto genérico - mantendo arquivos na raiz"
}

create_sample_html() {
    cat > "index.html" << 'EOF'
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DesignAuto - Dark Mode</title>
    
    <!-- DesignAuto Theme System -->
    <link rel="stylesheet" href="theme-variables.css">
    <link rel="stylesheet" href="theme-components.css">
    <script src="theme-controller.js"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border-primary);
        }
        
        .demo-content {
            padding: 40px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🎨 DesignAuto</h1>
            <button class="theme-toggle" onclick="toggleTheme()" title="Alternar tema">
                <div class="theme-toggle-slider">
                    <span class="theme-icon sun-icon">☀️</span>
                    <span class="theme-icon moon-icon">🌙</span>
                </div>
            </button>
        </header>
        
        <main class="demo-content">
            <div class="designauto-card" style="padding: 30px; margin-bottom: 20px;">
                <h2>Modo Escuro Implementado! 🌙</h2>
                <p class="text-secondary">
                    O sistema de tema foi instalado com sucesso. 
                    Clique no botão acima ou use <kbd>Ctrl+Shift+D</kbd> para alternar.
                </p>
                
                <button class="designauto-btn" onclick="alert('Funcionando!')">
                    Testar Botão
                </button>
                
                <input type="text" class="designauto-input" placeholder="Input de exemplo" 
                       style="margin-left: 10px; width: 200px;">
            </div>
            
            <div class="designauto-card" style="padding: 20px;">
                <h3>Recursos Implementados</h3>
                <ul class="text-secondary">
                    <li>✅ Sistema de cores CSS variables</li>
                    <li>✅ Toggle suave entre temas</li>
                    <li>✅ Persistência no localStorage</li>
                    <li>✅ Detecção automática do sistema</li>
                    <li>✅ Atalho de teclado (Ctrl+Shift+D)</li>
                    <li>✅ Componentes responsivos</li>
                </ul>
            </div>
        </main>
    </div>
</body>
</html>
EOF
}

# ================================================================
# FASE 5: CONFIGURAÇÃO DO REPLIT
# ================================================================

configure_replit() {
    echo -e "${GREEN}⚙️  FASE 5: CONFIGURAÇÃO ESPECÍFICA DO REPLIT${NC}"
    echo "============================================="
    
    # Verificar/criar .replit
    if [ ! -f ".replit" ]; then
        echo "📝 Criando arquivo .replit..."
        
        case $PROJECT_TYPE in
            "nodejs")
                create_replit_config_nodejs
                ;;
            "python")
                create_replit_config_python
                ;;
            *)
                create_replit_config_static
                ;;
        esac
        
        echo "✅ Configuração .replit criada"
    else
        echo "✅ Arquivo .replit já existe"
    fi
    
    # Verificar/criar replit.nix
    if [ ! -f "replit.nix" ]; then
        echo "📝 Criando arquivo replit.nix..."
        cat > "replit.nix" << 'EOF'
{ pkgs }: {
  deps = [
    pkgs.nodejs-18_x
    pkgs.nodePackages.live-server
  ];
}
EOF